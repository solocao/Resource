//页面加载就会调用操作
$(function() {
	// 页面加载完成后，调用查询所有产品操作
	findAllProduct();
})

// 查询所有的产品信息
function findAllProduct() {
	// 1.向服务器发送请求
	var url = "/p2p_management/product?method=findAll"
	$.post(url, function(data) {

		var jsonObj = eval(data); // 处理json数据

		var html = "";

		for (var i = 0; i < jsonObj.length; i++) {
			html += "<tr><td>" + (i + 1) + "</td><td>" + (jsonObj[i].proNum)
					+ "</td><td>" + (jsonObj[i].proName) + "</td><td>"
					+ (jsonObj[i].proLimit) + "</td><td>"
					+ (jsonObj[i].annualized)
					+ "%</td><td><a href='javascript:void(0)' onclick=findById("
					+ (jsonObj[i].id) + ")>编辑</a></td></tr>"
		}

		// 将转换成的html代码显示在页面上
		$("#pbody").html(html);

	}, "json");
}
// 关闭操作
function shutdown() {
	$.post("/p2p_management/user?method=shutdown", function() {
		// 将浏览器窗口关闭
		var flag = window.confirm("确认关闭窗口吗");
		if (flag) {
			// window.close(); // 它存在浏览器的兼容问题
			if (navigator.userAgent.indexOf("MSIE") > 0) {
				if (navigator.userAgent.indexOf("MSIE 6.0") > 0) {
					window.opener = null;
					window.close();
				} else {
					window.open('', '_top');
					window.top.close();
				}
			} else if (navigator.userAgent.indexOf("Firefox") > 0) {
				window.location.href = 'about:blank ';
			} else {
				window.opener = null;
				window.open('', '_self', '');
				window.close();
			}

		}
	});
};